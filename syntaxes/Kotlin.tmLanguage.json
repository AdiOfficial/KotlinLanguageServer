{
	"name": "Kotlin",
	"scopeName": "source.kotlin",
	"patterns": [
		{
			"include": "#import"
		},
		{
			"include": "#package"
		},
		{
			"include": "#code"
		}
	],
	"repository": {
		"import": {
			"begin": "\\b(import)\\b\\s*",
			"beginCaptures": {
				"1": {
					"name": "storage.type.import.kotlin"
				}
			},
			"end": "\\s*(;)|\\s*$\n?",
			"name": "meta.import.kotlin",
			"contentName": "entity.name.package.kotlin",
			"patterns": [
				{
					"include": "#comments"
				},
				{
					"match": "(?<=\\.)\\s*\\.|\\.(?=\\s*;)",
					"name": "invalid.illegal.character_not_allowed_here.kotlin"
				},
				{
					"match": "(?<!\\.)\\s*\\*",
					"name": "invalid.illegal.character_not_allowed_here.kotlin"
				},
				{
					"match": "(?<!_)_(?=\\s*(\\.|;))|\\b\\d+|-+",
					"name": "invalid.illegal.character_not_allowed_here.kotlin"
				},
				{
					"match": "(?x)\\b(?<!\\$)\n(abstract|assert|boolean|break|byte|case|catch|char|class|\nconst|continue|default|do|double|else|enum|extends|final|\nfinally|float|for|goto|if|implements|import|instanceof|int|\ninterface|long|native|new|package|private|protected|public|\nreturn|short|static|strictfp|super|switch|syncronized|this|\nthrow|throws|transient|try|void|volatile|while|\ntrue|false|null)\\b",
					"name": "invalid.illegal.character_not_allowed_here.kotlin"
				},
				{
					"match": "\\*",
					"name": "variable.language.wildcard.kotlin"
				}
			]
		},
		"package": {
			"begin": "\\b(package)\\b\\s*",
			"beginCaptures": {
				"1": {
					"name": "storage.type.package.kotlin"
				}
			},
			"end": "\\s*(;)|\\s*$\n?",
			"name": "meta.package.kotlin",
			"contentName": "entity.name.package.kotlin",
			"patterns": [
				{
					"include": "#comments"
				},
				{
					"match": "(?<=\\.)\\s*\\.|\\.(?=\\s*;)",
					"name": "invalid.illegal.character_not_allowed_here.kotlin"
				},
				{
					"match": "(?<!_)_(?=\\s*(\\.|;))|\\b\\d+|-+",
					"name": "invalid.illegal.character_not_allowed_here.kotlin"
				},
				{
					"match": "(?x)\\b(?<!\\$)\n(abstract|assert|boolean|break|byte|case|catch|char|class|\nconst|continue|default|do|double|else|enum|extends|final|\nfinally|float|for|goto|if|implements|import|instanceof|int|\ninterface|long|native|new|package|private|protected|public|\nreturn|short|static|strictfp|super|switch|syncronized|this|\nthrow|throws|transient|try|void|volatile|while|\ntrue|false|null)\\b",
					"name": "invalid.illegal.character_not_allowed_here.kotlin"
				}
			]
		},
		"code": {
			"patterns": [
				{
					"include": "#annotations"
				},
				{
					"include": "#class-declaration"
				},
				{
					"include": "#object-declaration"
				},
				{
					"include": "#function-declaration"
				},
				{
					"include": "#variable-declaration"
				},
				{
					"include": "#type-annotation"
				}
			]
		},
		"annotations": {
			"patterns": [
				{
					"include": "#annotation"
				},
				{
					"include": "#annotation-with-site"
				},
				{
					"include": "#annotation-with-list"
				}
			]
		},
		"annotation": {
			"patterns": [
				{
					"include": "#annotation-simple"
				},
				{
					"include": "#annotation-call"
				}
			]
		},
		"annotation-simple": {
			"match": "(@[\\w\\.]+)\\b(?!:|\\[|\\()",
			"captures": {
				"1": {
					"name": "entity.name.type.kotlin"
				}
			},
			"name": "meta.declaration.annotation.kotlin"
		},
		"annotation-call": {
			"begin": "(@[\\w\\.]+)(\\()",
			"beginCaptures": {
				"1": {
					"name": "entity.name.type.kotlin"
				}
			},
			"end": "\\)",
			"name": "meta.declaration.annotation.kotlin",
			"patterns": [
				{
					"include": "#annotation-args"
				}
			]
		},
		"annotation-with-site": {
			"patterns": [
				{
					"include": "#annotation-with-site-simple"
				},
				{
					"include": "#annotation-with-site-call"
				}
			]
		},
		"annotation-with-site-simple": {
			"match": "(@\\w+):\\s*([\\w\\.]+)\\b(?!:|\\[|\\()",
			"captures": {
				"1": {
					"name": "entity.name.type.kotlin"
				},
				"2": {
					"name": "entity.name.type.kotlin"
				}
			},
			"name": "meta.declaration.annotation.kotlin"
		},
		"annotation-with-site-call": {
			"begin": "(@\\w+):\\s*([\\w\\.]+)(\\()",
			"beginCaptures": {
				"1": {
					"name": "entity.name.type.kotlin"
				},
				"2": {
					"name": "entity.name.type.kotlin"
				}
			},
			"end": "\\)",
			"name": "meta.declaration.annotation.kotlin",
			"patterns": [
				{
					"include": "#annotation-args"
				}
			]
		},
		"annotation-with-list": {
			"begin": "(@\\w+):\\s*(\\[)",
			"beginCaptures": {
				"1": {
					"name": "entity.name.type.kotlin"
				}
			},
			"end": "\\]",
			"name": "meta.declaration.annotation.kotlin",
			"patterns": [
				{
					"include": "#unescaped-annotation"
				}
			]
		},
		"unescaped-annotation": {
			"patterns": [
				{
					"include": "#unescaped-annotation-simple"
				},
				{
					"include": "#unescaped-annotation-call"
				}
			]
		},
		"unescaped-annotation-simple": {
			"match": "([\\w\\.]+)\\b(?!:|\\[|\\()",
			"captures": {
				"1": {
					"name": "entity.name.type.kotlin"
				}
			},
			"name": "meta.declaration.annotation.kotlin"
		},
		"unescaped-annotation-call": {
			"begin": "([\\w\\.]+)(\\()",
			"beginCaptures": {
				"1": {
					"name": "entity.name.type.kotlin"
				}
			},
			"end": "\\)",
			"name": "meta.declaration.annotation.kotlin",
			"patterns": [
				{
					"include": "#annotation-args"
				}
			]
		},
		"annotation-args": {
			"patterns": [
				{
					"include": "#annotation-key"
				},
				{
					"include": "#code"
				}
			]
		},
		"annotation-key": {
			"match": "(\\w*)\\s*(=)",
			"captures": {
				"1": {
					"name": "constant.other.key.kotlin"
				},
				"2": {
					"name": "keyword.operator.assignment.kotlin"
				}
			}
		},
		"class-declaration": {
			"begin": "\\b(class|interface)\\b",
			"end": "\\(|$",
			"beginCaptures": {
				"1": {
					"name": "storage.type.class.kotlin"
				}
			},
			"patterns": [
				{
					"include": "#type-parameters"
				},
				{
					"match": "\\b\\w+\\b",
					"name": "entity.name.type.class.kotlin"
				}
			]
		},
		"object-declaration": {
			"match": "\\b(object)\\s+(\\w+)\\b",
			"captures": {
				"1": {
					"name": "storage.type.object.kotlin"
				},
				"2": {
					"name": "entity.name.type.object.kotlin"
				}
			}
		},
		"function-declaration": {
			"begin": "\\b(fun)\\b",
			"end": "\\(",
			"beginCaptures": {
				"1": {
					"name": "storage.type.function.kotlin"
				}
			},
			"patterns": [
				{
					"include": "#type-parameters"
				},
				{
					"match": "\\b\\w+\\b",
					"name": "entity.name.type.function.kotlin"
				}
			]
		},
		"variable-declaration": {
			"begin": "\\b(val|var)\\b",
			"end": "=",
			"beginCaptures": {
				"1": {
					"name": "storage.type.variable.kotlin"
				}
			},
			"patterns": [
				{
					"include": "#type-parameters"
				},
				{
					"match": "\\b\\w+\\b",
					"name": "variable.kotlin"
				}
			]
		},
		"type-parameters": {
			"begin": "<",
			"end": ">",
			"patterns": [
				{
					"include": "#type-parameter"
				}
			]
		},
		"type-parameter": {
			"patterns": [
				{
					"match": "\\b[A-Z]\\w*\\b",
					"name": "entity.name.type.parameter.kotlin"
				},
				{
					"match": "in|out",
					"name": "storage.modifier.kotlin"
				}
			]
		},
		"type-annotation": {
			"match": ":\\s+(\\w+)",
			"captures": {
				"1": {
					"name": "entity.name.type.kotlin"
				}
			}
		}
	}
}